<form class="chat-input" (submit)="handleSubmit($event)" novalidate>
  <div class="chat-input__bar">
    <div class="chat-input__pill">
      <span class="status-dot" [class.status-dot--sending]="sending()"></span>
      <span>{{ sending() ? 'sending to apt' : 'ready for your next command' }}</span>
    </div>
    <div class="chat-input__hint">
      <span>enter to send</span>
      <span class="dot">â€¢</span>
      <span>shift + enter for newline</span>
    </div>
  </div>

  <div class="chat-input__field">
    <span class="prompt-user">you</span>
    <span class="prompt-symbol">$</span>
    <textarea
      #inputField
      name="command"
      [value]="draft()"
      placeholder="Type here to talk to APT CLI..."
      (input)="onInput($event)"
      (keydown)="onKeydown($event)"
      [disabled]="sending()"
      rows="1"
      aria-label="Message for APT CLI"
    ></textarea>
  </div>

  <div class="chat-input__actions">
    <div class="chat-input__statusline">
      <ng-container *ngIf="draft().trim().length; else readyCopy">
        Draft autosaved locally for this session.
      </ng-container>
      <ng-template #readyCopy>Drafts persist per profile in this browser.</ng-template>
    </div>
    <div class="chat-input__buttons">
      <button
        class="chat-button chat-button--ghost"
        type="button"
        (click)="clearDraft()"
        [disabled]="!draft().length || sending()"
      >
        clear
      </button>
      <button
        class="chat-button chat-button--primary"
        type="submit"
        [disabled]="sending() || !draft().trim()"
      >
        {{ sending() ? 'sending...' : 'send' }}
      </button>
    </div>
  </div>

  <p class="input-error" *ngIf="error() as cmdError">{{ cmdError }}</p>
</form>
